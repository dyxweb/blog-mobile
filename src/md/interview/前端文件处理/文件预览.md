## 文件预览
### 图片预览
```
<img src={url} />
```
### word文件预览
- 安装依赖
```
npm i docx-preview --save
```
- 使用
```
import React, { useEffect, useRef } from 'react';
import { renderAsync } from 'docx-preview';

const DocxPreviewModal = (props) => {
  const { data } = props; // data的格式是blob文件流
  const docxPreviewRef = useRef(null); // 展示文件的dom

  // 预览
  useEffect(() => {
    renderAsync(data, docxPreviewRef.current);
  }, []);

  return (
    <div ref={docxPreviewRef}></div>
  );
};
```
### excel文件预览
- 安装依赖
```
npm i xlsx docx-preview --save
```
- 使用
```
import React, { useEffect, useRef } from 'react';
import { renderAsync } from 'docx-preview';
import XLSX from 'xlsx';

const XlsxPreviewModal = (props) => {
  const { data } = props; // data的格式是blob文件流
  const xlsxPreviewRef = useRef(null); // 展示文件的dom

  // 预览
  useEffect(() => {
    const reader = new FileReader();
    // 通过readAsArrayBuffer将blob转换为ArrayBuffer
    reader.readAsArrayBuffer(data) // data的格式是blob文件流
    reader.onload = (event) => {
      // 读取ArrayBuffer数据变成Uint8Array
      const transData = new Uint8Array(event.target.result);
      // 这里的transData里面的类型和后面的type类型要对应
      const workbook = XLSX.read(transData, { type: "array" });
      const sheetNames = workbook.SheetNames; // 工作表名称
      const worksheet = workbook.Sheets[sheetNames[0]];
      // const excelData = XLSX.utils.sheet_to_json(worksheet); //JSON
      const html = XLSX.utils.sheet_to_html(worksheet);
      xlsxPreviewRef.current.innerHTML = html;
    };
  }, []);

  return (
    <div ref={xlsxPreviewRef}></div>
  );
};
```
### pdf文件预览
- 下载pdf.js资源，下载适用旧版本浏览器的资源
- 将资源放在和项目index.html相同的目录下。
- 项目中使用pdf.js实现预览pdf文件。
```
// pdfUrl为需要预览的pdf文件资源路径
<iframe
  src={`/pdfjs/web/viewer.html?file=${encodeURIComponent(pdfUrl)}`}
  width="100%"
  height="100%"
/>
```
