## 虚拟DOM
- 原生的JavaScript我们直接对DOM进行创建和更改，而React会先将JSX代码转换成一个JavaScript对象，然后再将这个JavaScript对象转换成真实DOM。这个JavaScript对象就是所谓的虚拟DOM。
- 当需要创建或更新元素时，React会先对虚拟DOM对象进行创建或更改，然后再将虚拟DOM对象渲染成真实DOM。
### 虚拟DOM优点
#### 提高开发效率，代码逻辑更易维护
- 使用JavaScript，我们很大的关注点在于如何更新DOM。使用React不必自己去完成属性操作、事件处理、DOM更新，React会替我们完成这一切。
- 我们可以更关注我们的业务逻辑而非DOM操作，可大大提升我们的开发效率。
#### 性能提升 **浏览器在处理DOM的时候会很慢，处理JavaScript会很快**
- 直接操作DOM是非常耗费性能的，React使用虚拟DOM也是无法避免操作DOM的。如果是首次渲染，虚拟DOM并不具有优势，甚至要进行更多的计算，消耗更多的内存。
- 虚拟DOM的优势在于React的Diff算法和批处理策略，React在更新真实DOM之前，提前计算好了如何进行更新和渲染DOM。实际上这个计算过程我们在直接操作DOM时，也是可以自己判断和实现的，但是一定会耗费非常多的精力和时间，而且往往我们自己做的是不如React好，React帮助我们计算如何更高效的更新，而不是它比DOM操作更快，在这个过程中React帮助我们提升了性能。
- 只有虚拟DOM并不能提升性能，虚拟DOM + Diff算法才能真正的提高性能。
#### 事件机制跨浏览器兼容
- React基于虚拟DOM自己实现了一套事件机制，自己模拟了事件冒泡和捕获的过程，采用事件代理，批量更新等方法，抹平了各个浏览器的事件兼容性问题。
#### 跨平台兼容
- 以React Native为例子，根据虚拟DOM绘制出对应平台的ui层。
### 虚拟DOM缺点
- ⾸次渲染⼤量DOM时，由于多了⼀层虚拟DOM的计算，会⽐直接操作真实DOM慢。
- ⽆法进⾏极致优化，虽然虚拟DOM + 合理的优化，⾜以应对绝⼤部分应⽤的性能需求，但在⼀些性能要求极⾼的应⽤中虚拟DOM⽆法进⾏针对性的极致优化。
### 使用了虚拟DOM不一定会比直接渲染真实DOM快
- React框架给的保证是在不需要手动优化的情况下，可以提供过得去的性能。
- 浏览器在处理DOM的时候会很慢，处理JavaScript会很快，Diff过程是JS层面的操作，用途就是减少后续的真实DOM操作。
### 虚拟DOM的结构
```
{
  "type": "div", 
  "props": {
    "id": "foo", 
    "children": [
      {
        "type": "a", 
        "props": {
          "children": [
            {
              "type": "TEXT_ELEMENT", 
              "props": {
                "nodeValue": "bar", 
                "children": []
              }
            }
          ]
        }
      }, 
      {
        "type": "b", 
        "props": {
          "children": []
        }
      }
    ]
  }
}
```

